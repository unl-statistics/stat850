[
  {
    "objectID": "slides/12-simulation.html#linear-regression-assumptions",
    "href": "slides/12-simulation.html#linear-regression-assumptions",
    "title": "Simulation Using Built-In Functions",
    "section": "Linear Regression Assumptions",
    "text": "Linear Regression Assumptions\n\nLinearity and Additivity of DVs\nIndependence of Errors\nConstant Variance of Errors\nNormality of Errors"
  },
  {
    "objectID": "slides/12-simulation.html#how-bad-is-it-linearity",
    "href": "slides/12-simulation.html#how-bad-is-it-linearity",
    "title": "Simulation Using Built-In Functions",
    "section": "How Bad is it? – Linearity",
    "text": "How Bad is it? – Linearity\n\n\nlibrary(tidyverse)\nset.seed(2034927344)\ndata &lt;- tibble(\n  x1 = seq(-10, 10, \n           length.out = 100) + \n    runif(100, -.1, .1), # wiggle\n  x2 = seq(10, -10, \n           length.out = 100) + \n    runif(100, -.1, .1), # wiggle\n  \n  # Definitely not linear\n  y =  x1 + x1^2/2 + # main effect\n    rnorm(100, 0, 10) # actual error\n)\n\nggplot(data, aes(x = x1, y = y)) + \n  geom_point()\n\n\n\n\n\n\n\n\n\nClearly non-linear"
  },
  {
    "objectID": "slides/12-simulation.html#how-bad-is-it-linearity-1",
    "href": "slides/12-simulation.html#how-bad-is-it-linearity-1",
    "title": "Simulation Using Built-In Functions",
    "section": "How Bad is it? – Linearity",
    "text": "How Bad is it? – Linearity\n\n\nmodel &lt;- lm(y ~ x1 + x2, data = data)\nsummary(model)\n\n\n\nCall:\nlm(formula = y ~ x1 + x2, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-35.805 -15.641  -1.853  16.714  44.165 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)   16.457      1.913   8.605 1.37e-13 ***\nx1           -20.473     24.200  -0.846    0.400    \nx2           -21.413     24.238  -0.883    0.379    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 19.08 on 97 degrees of freedom\nMultiple R-squared:  0.07991,   Adjusted R-squared:  0.06094 \nF-statistic: 4.212 on 2 and 97 DF,  p-value: 0.01761"
  },
  {
    "objectID": "slides/12-simulation.html#how-bad-is-it",
    "href": "slides/12-simulation.html#how-bad-is-it",
    "title": "Simulation Using Built-In Functions",
    "section": "How Bad is it?",
    "text": "How Bad is it?\n\nmodel2 &lt;- lm(y ~ x1 + I(x1^2), data = data)\nsummary(model2)\n\n\nCall:\nlm(formula = y ~ x1 + I(x1^2), data = data)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-29.1382  -6.9539  -0.2898   5.4694  30.6999 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -1.30483    1.55887  -0.837    0.405    \nx1           0.90094    0.17844   5.049 2.08e-06 ***\nI(x1^2)      0.51842    0.03407  15.214  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 10.41 on 97 degrees of freedom\nMultiple R-squared:  0.7261,    Adjusted R-squared:  0.7205 \nF-statistic: 128.6 on 2 and 97 DF,  p-value: &lt; 2.2e-16"
  },
  {
    "objectID": "slides/12-simulation.html#models",
    "href": "slides/12-simulation.html#models",
    "title": "Simulation Using Built-In Functions",
    "section": "Models",
    "text": "Models"
  },
  {
    "objectID": "slides/12-simulation.html#simulation-questions",
    "href": "slides/12-simulation.html#simulation-questions",
    "title": "Simulation Using Built-In Functions",
    "section": "Simulation – Questions",
    "text": "Simulation – Questions\n\nHow does \\(\\hat{s}\\) compare to \\(\\sigma=10\\)?\nHow does \\(\\hat\\alpha\\) compare to true value \\(\\alpha=1\\)?\nHow does \\(\\hat\\beta\\) compare to true value \\(\\beta=0\\)?"
  },
  {
    "objectID": "slides/12-simulation.html#simulation-linearity-assumption",
    "href": "slides/12-simulation.html#simulation-linearity-assumption",
    "title": "Simulation Using Built-In Functions",
    "section": "Simulation – Linearity assumption",
    "text": "Simulation – Linearity assumption\n\nsim_linearity &lt;- function(i, n = 100, formula = y ~ x1+x2, trueformula = y ~ x1 + I(x1^2)) {\n  data &lt;- tibble(\n    x1 = seq(-10, 10, length.out = n) + runif(n, -.1, .1),\n    x2 = seq(-10, 10, length.out = n) + runif(n, -.1, .1),\n    y =  x1 + x1^2/2 + rnorm(n, 0, 10) # Definitely not additive or linear\n  )\n  \n  model &lt;- lm(formula = formula, data = data)\n  model2 &lt;- lm(formula = trueformula, data = data)\n  tibble(\n    i = i, \n    data = list(data), \n    model = tibble(type = c(\"misspec\", \"actual\"), \n                   model = list(model, model2))\n         )\n}\n\nset.seed(249382736)\nsim_n &lt;- map_df(1:1000, ~sim_linearity(.)) |&gt; \n  unnest(model)"
  },
  {
    "objectID": "slides/12-simulation.html#simulation-getting-estimates-out",
    "href": "slides/12-simulation.html#simulation-getting-estimates-out",
    "title": "Simulation Using Built-In Functions",
    "section": "Simulation – Getting Estimates Out",
    "text": "Simulation – Getting Estimates Out\n\nlibrary(broom) # very useful for tidying nested model dataframes\n\nsim_n &lt;- sim_n |&gt; mutate(\n  # One line per parameter\n  tidy_model = purrr::map(model, tidy), \n  # One line per model\n  glance_model = purrr::map(model, glance))"
  },
  {
    "objectID": "slides/12-simulation.html#error-variance",
    "href": "slides/12-simulation.html#error-variance",
    "title": "Simulation Using Built-In Functions",
    "section": "Error Variance",
    "text": "Error Variance\n\ntmp &lt;- sim_n |&gt;\n  unnest(glance_model)\nggplot(tmp, aes(x = sigma, fill = type)) + \n  geom_density() + \n  geom_vline(xintercept = 10, linetype = \"dashed\")"
  },
  {
    "objectID": "slides/12-simulation.html#alpha-coefficient",
    "href": "slides/12-simulation.html#alpha-coefficient",
    "title": "Simulation Using Built-In Functions",
    "section": "\\(\\alpha\\) coefficient",
    "text": "\\(\\alpha\\) coefficient\n\nsim_n|&gt;\n  unnest(tidy_model) |&gt; filter(term == \"x1\") |&gt;\n  ggplot(aes(x = estimate, fill = type)) + \n  geom_density() + \n  geom_vline(xintercept = 1, linetype = \"dashed\") + \n  facet_wrap(~type, scales=\"free\")\n\n\nThat is some wide error variance!"
  },
  {
    "objectID": "slides/12-simulation.html#beta-coefficient",
    "href": "slides/12-simulation.html#beta-coefficient",
    "title": "Simulation Using Built-In Functions",
    "section": "\\(\\beta\\) coefficient",
    "text": "\\(\\beta\\) coefficient\n\n\nsim_n|&gt;\n  unnest(tidy_model) |&gt;\n  # Only occurs in misspec model\n  filter(term == \"x2\") |&gt;\n  ggplot(aes(x = estimate, fill = type)) + \n  geom_density(alpha=0.5) + \n  geom_vline(xintercept = 0, \n             linetype = \"dashed\")"
  }
]